<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Voice to Text (English + Tamil)</title>

<style>
body{
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#4facfe,#00f2fe);
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.container{
  background:white;
  padding:20px;
  border-radius:15px;
  width:520px;
  box-shadow:0 10px 25px rgba(0,0,0,0.2);
  text-align:center;
}

textarea{
  width:100%;
  height:160px;
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  border:1px solid #ccc;
  resize:none;
  font-size:16px;
}

button,select{
  margin:5px;
  padding:10px 15px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:14px;
}

.start{background:#28a745;color:white;}
.stop{background:#dc3545;color:white;}
.copy{background:#007bff;color:white;}
.clear{background:#6c757d;color:white;}
.download{background:#ff9800;color:white;}
</style>
</head>

<body>

<div class="container">
  <h3>ðŸŽ¤ Voice to Text</h3>

  <!-- Language -->
  <select id="language">
    <option value="en-IN">English</option>
    <option value="ta-IN">Tamil</option>
  </select>

  <!-- Mode -->
  <select id="mode">
    <option value="normal">Normal Mode</option>
    <option value="continue">Continue Mode</option>
  </select>

  <br>

  <button class="start" onclick="startRecognition()">Start</button>
  <button class="stop" onclick="stopRecognition()">Stop</button>
  <button class="copy" onclick="copyText()">Copy</button>
  <button class="clear" onclick="clearText()">Clear</button>
  <button class="download" onclick="downloadWord()">Download Word</button>

  <textarea id="output" placeholder="Your speech will appear here..."></textarea>
</div>

<script>
let recognition;
let isListening = false;
let finalTranscript = '';

if ('webkitSpeechRecognition' in window) {
  recognition = new webkitSpeechRecognition();
  recognition.continuous = true;
  recognition.interimResults = true;

  recognition.onresult = function(event) {
    let interimTranscript = '';

    for (let i = event.resultIndex; i < event.results.length; ++i) {
      if (event.results[i].isFinal) {
        finalTranscript += event.results[i][0].transcript + ' ';
      } else {
        interimTranscript += event.results[i][0].transcript;
      }
    }

    let mode = document.getElementById('mode').value;

    if (mode === "normal") {
      document.getElementById('output').value = interimTranscript;
    } else {
      document.getElementById('output').value = finalTranscript + interimTranscript;
    }
  };

  recognition.onerror = function(event) {
    alert("Error: " + event.error);
  };

} else {
  alert("Speech Recognition not supported in this browser. Use Chrome.");
}

function startRecognition() {
  if (!recognition) return;

  recognition.lang = document.getElementById('language').value;

  let mode = document.getElementById('mode').value;

  if (mode === "normal") {
    finalTranscript = '';
    document.getElementById('output').value = '';
  }

  recognition.start();
  isListening = true;
}

function stopRecognition() {
  if (recognition && isListening) {
    recognition.stop();
    isListening = false;
  }
}

function copyText() {
  let text = document.getElementById('output');
  text.select();
  document.execCommand("copy");
  alert("Text copied!");
}

function clearText() {
  document.getElementById('output').value = '';
  finalTranscript = '';
}

function downloadWord() {
  let text = document.getElementById('output').value;

  let blob = new Blob(
    ['\ufeff', text],
    { type: 'application/msword' }
  );

  let url = URL.createObjectURL(blob);
  let a = document.createElement("a");
  a.href = url;
  a.download = "voice-text.doc";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
</script>

</body>
</html>
